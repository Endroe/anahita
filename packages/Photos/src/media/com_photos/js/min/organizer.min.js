!function(t){"use strict";t.widget("anahita.setOrganizer",{options:{selector:"#photo-selector-list",url:t("#set-photos").data("url"),photos:t("#set-photos").find(".media-grid"),thumbnail:".thumbnail-wrapper"},_create:function(){var t=this;this.element.hide(),this.selector=null,this.photoList=null,this._on("body",{'click a[data-action="organize"]':function(o){o.preventDefault(),t._open(o.currentTarget.href)}}),this._on("body",{"click a.thumbnail-link":function(t){t.preventDefault()}}),this._on(this.element,{'click a[data-trigger="ClosePhotoSelector"]':function(o){o.preventDefault(),t._close()}})},_open:function(o){var e=this;t.get(o,function(o){e.element.html(o).slideDown(),e.selector=t(e.options.selector).sortable({connectWith:t(e.options.photos),scroll:!1}),e.photoList=t(e.options.photos).sortable({connectWith:t(e.options.selector),update:function(){e.options.url&&e._update()}})})},_close:function(){var t=this;this.element.slideUp("normal",function(){t.selector.sortable("destroy"),t.photoList.sortable("destroy"),t.element.empty()})},_update:function(){var o=this.photoList.find(this.options.thumbnail),e="action=updatephotos";t.each(o,function(o,n){e+="&photo_id[]="+t(n).attr("photo")}),t.ajax({method:"post",url:this.options.url,data:e})}}),t("#photo-selector").setOrganizer()}(jQuery,window);