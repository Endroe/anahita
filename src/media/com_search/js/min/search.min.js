!function(t,e,s){"use strict";t.widget("anahita.search",{options:{searchForm:'form[data-trigger="SearchRequest"]',sortOption:'select[data-trigger="SortOption"]',commentOption:'input[data-trigger="SearchOption"]',scope:'[data-trigger="ChangeScope"]',results:"#an-search-results",searchScopes:".search-scopes"},_create:function(){this.form=t(this.options.searchForm);var e=t(this.options.sortOption),s=t(this.options.commentOption),i=t(this.options.scope);this.searchOptions={layout:"results",sort:t(e).find("option:selected").val(),search_comments:t(s).is(":checked"),scope:t(i).data("scope")},this._on(this.form,{submit:function(t){t.preventDefault(),this.submit(this.form)}}),this._on(e,{change:function(e){e.preventDefault(),this.searchOptions.sort=t(e.currentTarget).find("option:selected").val(),this.submit(t(e.currentTarget))}}),this._on(s,{change:function(e){e.preventDefault(),this.searchOptions.search_comments=t(e.currentTarget).is(":checked"),this.submit(t(e.currentTarget))}}),this._initScopes()},_initScopes:function(){this._on(t(this.options.scope),{click:function(e){e.preventDefault(),this.searchOptions.scope=t(e.currentTarget).data("scope"),this.submit(t(e.currentTarget))}})},submit:function(e){var i=this;t.ajax({method:"get",url:this.form.attr("action")+"?"+this.form.serialize(),data:this.searchOptions,beforeSend:function(){e.fadeTo("fast",.3).addClass("uiActivityIndicator")},success:function(e){e=t(e),t(i.options.results).html(e.filter(".an-entity")),t(i.options.searchScopes).replaceWith(e.filter(i.options.searchScopes)),i._initScopes()},complete:function(){e.fadeTo("fast",1).removeClass("uiActivityIndicator");var o=i.form.attr("action")+"?"+i.form.serialize()+"&"+t.param(i.searchOptions);t(s).data("newUrl",o).trigger("urlChange")}})}});t("body").search()}(jQuery,window,document);